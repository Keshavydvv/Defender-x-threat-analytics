# Defender-X Threat Analytics for Microsoft Sentinel

## Overview

Defender-X Threat Analytics is an integrated detection and response solution designed using Microsoft Sentinel and Microsoft Defender for Endpoint. This project simulates real-world threats such as Mimikatz credential theft and PSAttackTool-based script execution, generates alerts in Defender, and automates incident response using Logic App playbooks. A custom workbook dashboard provides visual analysis of threats and trends for SOC teams.

---

## Key Features

- Real-time threat detection and alert ingestion via Microsoft Defender for Endpoint
- Automated incident creation in Microsoft Sentinel
- Logic App playbook for email alerting and advanced hunting queries
- Custom workbook visualizations showing alert trends, severity breakdown, and frequent attacks
- End-to-end simulation and response pipeline

---

## Architecture

Microsoft Defender for Endpoint
↓ Alerts
Microsoft Sentinel → Analytics Rule → Incident
→ Logic App (Auto-response)
→ Workbook Visualization

---

## Components

### Analytics Rules

- Detect Mimikatz Credential Theft
- Detect PSAttackTool Script Execution

### Logic App Playbook

- AlertResponse (JSON file included in `/playbooks`)

This playbook triggers on Sentinel alerts and performs automated responses such as sending email and running Defender Advanced Hunting queries on suspicious activity.

### Workbook Visualizations

The custom workbook visualizes alert data using KQL queries in the following ways:

- Area chart for alert frequency over time
- Pie chart for alert severity distribution
- Grid for top 5 most frequent alert names

### KQL Queries Used

// Trend over time (Area Chart)
SecurityAlert
| where TimeGenerated > ago(1d)
| summarize Count = count() by AlertName, bin(TimeGenerated, 1h)
| sort by TimeGenerated desc

// Alert severity breakdown (Pie Chart)
SecurityAlert
| summarize count() by AlertSeverity
| sort by count_ desc

// Top 5 frequent alerts (Grid)
SecurityAlert
| summarize Total = count() by AlertName
| top 5 by Total


Screenshots
1. Sentinel Workbook Dashboard
Includes area chart, pie chart, and alert summary grid.

2. Mimikatz Incident Triggered
Shows incident in Sentinel generated by the analytics rule.

3. Microsoft Defender Alert Timeline
Illustrates alert details and command-line execution chain.

4. Logic App Playbook Execution
Displays Logic App flow and Advanced Hunting query step.


How to Use
Connect Microsoft Defender for Endpoint to Microsoft Sentinel.

Import the Analytics Rules provided in this repository.

Deploy the Logic App playbook from /playbooks/HoneyTrap-AlertResponse.json.

Simulate a credential theft scenario using Mimikatz or run PowerShell-based test scripts.

Confirm alerts are ingested into Microsoft Sentinel.

Validate automated response and review incidents.

Use the workbook to visualize trends and SOC-level insights.

Repository Structure

/playbooks/	   Logic App playbook used for auto-response
/queries/    	 KQL queries used in Sentinel workbooks
/images/	     Dashboard and incident screenshots
/README.md/	   Full project documentation

Tools Used
Microsoft Sentinel

Microsoft Defender for Endpoint

Microsoft Logic Apps

Azure Workbook Editor

Mimikatz (for credential theft simulation)

Author
Keshav Yadav
Cybersecurity and Cloud Enthusiast
Engineering Student, Dayananda Sagar College of Engineering
